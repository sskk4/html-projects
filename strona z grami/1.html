<!DOCTYPE HTML>
<html lang="pl">
<head>
	<meta charset="utf-8" />
	<title>SONIC</title>
	<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
	<meta name="description" content="PIXELART" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	
	<!-- Ruffle Flash Emulator -->
	<script src="https://unpkg.com/@ruffle-rs/ruffle"></script>
	
	<style>
	body {
		margin: 0;
		padding: 0;
	}
	
	#container {
		width: 1000px;
		margin-left: auto;
		margin-right: auto;
	}
	
	#logo {
		width: 1000px;
		text-align: left;
		background-color: red;
		color: white;
		padding: 15px;
	}
	
	#co {
		float: up;
		text-align: center;
	}
	
	#co2 {
		float: up;
		text-align: center;
	}

	#hehe {
		padding: 15px;
		background-color: red;
		float: up;
		width: 1000px;
	}

	.przyklad {
		overflow: hidden;
		padding: 15px;
		width: 1000px;
		height: 20px;
		background-color: red;
	}
	
	.przyklad img {
		transition-duration: 3s;
		margin: 0 auto;
		display: block;
	}
	
	.przyklad img:hover {
		transform: scale(1.2);
		-webkit-transform: scale(1.2);
		-moz-transform: scale(1.2);
		z-index: 0;
	}
	
	#hehe2 {
		float: up;
		background-color: red;
		padding: 15px;
		width: 1000px;
		min-height: 300px;
	}
	
	#hehe3 {
		both: clear;
		float: up;
		width: 1000px;
		min-height: 30px;
	}
	
	#hehe4 {
		float: left;
		width: 1000px;
		background-color: red;
		padding: 15px;
	}
	
	#hehe5 {
		both: clear;
		float: up;
		width: 1000px;
		min-height: 30px;
	}
	
	/* Retro kontroler na dole strony */
	#mobile-controls {


	}
	
	.controls-title {
		color: #ff0000;
		text-align: center;
		font-size: 24px;
		font-weight: bold;
		margin-bottom: 25px;
		text-shadow: 2px 2px 4px rgba(0,0,0,0.8), 0 0 10px rgba(255,0,0,0.5);
		letter-spacing: 3px;
	}
	
	.control-layout {
		display: flex;
		justify-content: space-between;
		align-items: center;
		padding: 0 40px;
	}
	
	/* Joystick style */
	.joystick-container {
		position: relative;
		width: 220px;
		height: 220px;
	}
	
	.joystick-base {
		position: absolute;
		width: 220px;
		height: 220px;
		background: radial-gradient(circle, #333 0%, #1a1a1a 70%);
		border: 6px solid #555;
		border-radius: 50%;
		box-shadow: 
			inset 0 0 20px rgba(0,0,0,0.8),
			inset 0 0 40px rgba(0,0,0,0.4),
			0 4px 8px rgba(0,0,0,0.6);
	}
	
	.joystick-stick {
		position: absolute;
		width: 100px;
		height: 100px;
		background: radial-gradient(circle at 30% 30%, #666, #2a2a2a);
		border: 4px solid #444;
		border-radius: 50%;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		box-shadow: 
			0 6px 12px rgba(0,0,0,0.6),
			inset 0 -2px 4px rgba(0,0,0,0.5),
			inset 0 2px 4px rgba(255,255,255,0.1);
		cursor: pointer;
		touch-action: none;
		user-select: none;
		-webkit-user-select: none;
		transition: all 0.1s ease;
	}
	
	.joystick-stick:active {
		box-shadow: 
			0 2px 4px rgba(0,0,0,0.8),
			inset 0 -2px 4px rgba(0,0,0,0.7),
			inset 0 2px 4px rgba(255,255,255,0.05);
	}
	
	.joystick-stick.active {
		background: radial-gradient(circle at 30% 30%, #888, #3a3a3a);
	}
	
	/* Przyciski akcji po prawej */
	.action-buttons {
		display: flex;
		flex-direction: column;
		gap: 15px;
	}
	
	.action-row {
		display: flex;
		gap: 15px;
		justify-content: center;
	}
	
	.action-btn {
		background: linear-gradient(145deg, #8a0000, #c00000);
		color: #fff;
		border: 4px solid #600;
		border-radius: 12px;
		width: 95px;
		height: 80px;
		font-size: 18px;
		font-weight: bold;
		font-family: 'Courier New', monospace;
		touch-action: none;
		user-select: none;
		-webkit-user-select: none;
		cursor: pointer;
		transition: all 0.1s;
		display: flex;
		align-items: center;
		justify-content: center;
		text-align: center;
		box-shadow: 
			0 6px 0 #400,
			0 8px 12px rgba(0,0,0,0.5),
			inset 0 2px 4px rgba(255,255,255,0.2);
		text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
	}
	
	.action-btn:active,
	.action-btn.pressed {
		background: linear-gradient(145deg, #ffcc00, #ff9900);
		transform: translateY(4px);
		box-shadow: 
			0 2px 0 #cc6600,
			0 4px 8px rgba(0,0,0,0.5),
			inset 0 2px 4px rgba(255,255,255,0.3);
		border-color: #cc6600;
	}
	
	.action-btn.start-btn {
		background: linear-gradient(145deg, #006600, #009900);
		border-color: #004400;
		box-shadow: 
			0 6px 0 #004400,
			0 8px 12px rgba(0,0,0,0.5),
			inset 0 2px 4px rgba(255,255,255,0.2);
	}
	
	.action-btn.space-btn {
		background: linear-gradient(145deg, #666600, #999900);
		border-color: #444400;
		width: 205px;
		box-shadow: 
			0 6px 0 #444400,
			0 8px 12px rgba(0,0,0,0.5),
			inset 0 2px 4px rgba(255,255,255,0.2);
	}
	
	.action-btn.start-btn:active,
	.action-btn.start-btn.pressed {
		background: linear-gradient(145deg, #00ff00, #00cc00);
		border-color: #009900;
		box-shadow: 
			0 2px 0 #009900,
			0 4px 8px rgba(0,0,0,0.5),
			inset 0 2px 4px rgba(255,255,255,0.3);
	}
	
	.action-btn.space-btn:active,
	.action-btn.space-btn.pressed {
		background: linear-gradient(145deg, #ffff00, #cccc00);
		border-color: #999900;
		box-shadow: 
			0 2px 0 #999900,
			0 4px 8px rgba(0,0,0,0.5),
			inset 0 2px 4px rgba(255,255,255,0.3);
	}
	
	/* Dekoracyjne elementy */
	.joystick-base::before {
		content: '';
		position: absolute;
		width: 140px;
		height: 140px;
		border: 2px dashed #444;
		border-radius: 50%;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		opacity: 0.3;
	}
	
	.joystick-base::after {
		content: '';
		position: absolute;
		width: 100px;
		height: 100px;
		border: 2px dashed #555;
		border-radius: 50%;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		opacity: 0.2;
	}
	</style>

</head>

<body>
	<div id="container">
	
		<div id="logo">
			<a href="roksa.html"><img src="logo.png" alt="Logo" /></a> 
		</div>
		
		<div id="co2">
			<center><img src="lol.gif" width="442" height="232" alt="Animation" /></center>
		</div>
		
		<div id="co">
			<center></center>
		</div>
		
		<br /><br /><br />
	
		<div class="przyklad">
			<a href="top.html"><img src="logo2.png" alt="Top" width="189" height="20" class="alignleft size-medium wp-image-7000" align="left" /></a>
			<img src="logo4.png" alt="Menu" width="134" height="20" class="aligncleft size-medium wp-image-7000" align="right" />
			<img src="logo3.png" alt="Info" width="141" height="20" class="alignleft size-medium wp-image-7000" />
		</div>
  	   
		<div id="hehe3">
			<a href="inne.html"><center></center></a>
		</div>
		
		<div id="hehe2">
			<center>
				<embed src="gry/373.swf" width="490" height="350" />
			</center>
		</div>
		
		<br /><br /> 
		

		<div id="hehe5">
			<center><font color="white">dzien dobry</font></center> 
		</div>
		
		<!-- Retro kontroler na dole strony -->
		<div id="mobile-controls">
			<div class="control-layout">
				<!-- Joystick -->
				<div class="joystick-container">
					<div class="joystick-base"></div>
					<div class="joystick-stick" id="joystick"></div>
				</div>
				
				<!-- Przyciski akcji -->
				<div class="action-buttons">
					<div class="action-row">
						<button class="action-btn" data-key="z">Z</button>
						<button class="action-btn" data-key="x">X</button>
					</div>
					<div class="action-row">
						<button class="action-btn" data-key="c">C</button>
						<button class="action-btn start-btn" data-key="Enter">START</button>
					</div>
					<div class="action-row">
						<button class="action-btn space-btn" data-key=" ">SPACE</button>
					</div>
				</div>
			</div>
		</div>

	</div>

	<script>
		// Poczekaj aż Ruffle automatycznie załaduje embed
		let rufflePlayer = null;
		
		window.addEventListener("load", () => {
			setTimeout(() => {
				rufflePlayer = document.querySelector("ruffle-player") || document.querySelector("embed");
				if (rufflePlayer) {
					rufflePlayer.style.outline = "none";
					if (rufflePlayer.focus) rufflePlayer.focus();
				}
			}, 500);
		});
		
		// Funkcja do symulacji naciśnięcia klawisza
		function simulateKeyPress(key, eventType) {
			const player = document.querySelector("ruffle-player") || document.querySelector("embed");
			if (player) {
				const event = new KeyboardEvent(eventType, {
					key: key,
					code: getKeyCode(key).code,
					keyCode: getKeyCode(key).keyCode,
					which: getKeyCode(key).keyCode,
					charCode: getKeyCode(key).keyCode,
					bubbles: true,
					cancelable: true,
					view: window
				});
				
				player.dispatchEvent(event);
			}
			
			const docEvent = new KeyboardEvent(eventType, {
				key: key,
				code: getKeyCode(key).code,
				keyCode: getKeyCode(key).keyCode,
				which: getKeyCode(key).keyCode,
				charCode: getKeyCode(key).keyCode,
				bubbles: true,
				cancelable: true,
				view: window
			});
			
			document.dispatchEvent(docEvent);
			window.dispatchEvent(docEvent);
		}
		
		function getKeyCode(key) {
			const keyCodes = {
				"ArrowUp": { keyCode: 38, code: "ArrowUp" },
				"ArrowDown": { keyCode: 40, code: "ArrowDown" },
				"ArrowLeft": { keyCode: 37, code: "ArrowLeft" },
				"ArrowRight": { keyCode: 39, code: "ArrowRight" },
				"z": { keyCode: 90, code: "KeyZ" },
				"x": { keyCode: 88, code: "KeyX" },
				"c": { keyCode: 67, code: "KeyC" },
				" ": { keyCode: 32, code: "Space" },
				"Enter": { keyCode: 13, code: "Enter" }
			};
			return keyCodes[key] || { keyCode: 0, code: "" };
		}
		
		// Zarządzanie aktywnymi klawiszami
		let activeKeys = new Set();
		
		function pressKey(key) {
			if (activeKeys.has(key)) return;
			activeKeys.add(key);
			
			simulateKeyPress(key, "keydown");
			
			const player = document.querySelector("ruffle-player") || document.querySelector("embed");
			if (player && player.focus) {
				player.focus();
			}
		}
		
		function releaseKey(key) {
			activeKeys.delete(key);
			simulateKeyPress(key, "keyup");
		}
		
		// Obsługa Joysticka
		const joystick = document.getElementById('joystick');
		const joystickBase = joystick.parentElement;
		let isDragging = false;
		let currentDirection = null;
		
		const maxDistance = 60; // Maksymalna odległość od środka
		const deadZone = 15; // Strefa martwa
		
		function handleJoystickMove(clientX, clientY) {
			const rect = joystickBase.getBoundingClientRect();
			const centerX = rect.left + rect.width / 2;
			const centerY = rect.top + rect.height / 2;
			
			let deltaX = clientX - centerX;
			let deltaY = clientY - centerY;
			
			const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
			
			if (distance > maxDistance) {
				const angle = Math.atan2(deltaY, deltaX);
				deltaX = Math.cos(angle) * maxDistance;
				deltaY = Math.sin(angle) * maxDistance;
			}
			
			joystick.style.transform = `translate(calc(-50% + ${deltaX}px), calc(-50% + ${deltaY}px))`;
			
			// Określ kierunek
			let newDirection = null;
			
			if (distance > deadZone) {
				const angle = Math.atan2(deltaY, deltaX) * 180 / Math.PI;
				
				if (angle >= -45 && angle < 45) {
					newDirection = 'right';
				} else if (angle >= 45 && angle < 135) {
					newDirection = 'down';
				} else if (angle >= -135 && angle < -45) {
					newDirection = 'up';
				} else {
					newDirection = 'left';
				}
				
				joystick.classList.add('active');
			} else {
				joystick.classList.remove('active');
			}
			
			// Zarządzaj klawiszami
			if (newDirection !== currentDirection) {
				// Zwolnij stary kierunek
				if (currentDirection) {
					releaseKey('Arrow' + currentDirection.charAt(0).toUpperCase() + currentDirection.slice(1));
				}
				
				// Naciśnij nowy kierunek
				if (newDirection) {
					pressKey('Arrow' + newDirection.charAt(0).toUpperCase() + newDirection.slice(1));
				}
				
				currentDirection = newDirection;
			}
		}
		
		function resetJoystick() {
			isDragging = false;
			joystick.style.transform = 'translate(-50%, -50%)';
			joystick.classList.remove('active');
			
			if (currentDirection) {
				releaseKey('Arrow' + currentDirection.charAt(0).toUpperCase() + currentDirection.slice(1));
				currentDirection = null;
			}
		}
		
		// Touch events dla joysticka
		joystick.addEventListener('touchstart', (e) => {
			e.preventDefault();
			isDragging = true;
			const touch = e.touches[0];
			handleJoystickMove(touch.clientX, touch.clientY);
		});
		
		document.addEventListener('touchmove', (e) => {
			if (isDragging) {
				e.preventDefault();
				const touch = e.touches[0];
				handleJoystickMove(touch.clientX, touch.clientY);
			}
		});
		
		document.addEventListener('touchend', (e) => {
			if (isDragging) {
				e.preventDefault();
				resetJoystick();
			}
		});
		
		// Mouse events dla joysticka
		joystick.addEventListener('mousedown', (e) => {
			e.preventDefault();
			isDragging = true;
			handleJoystickMove(e.clientX, e.clientY);
		});
		
		document.addEventListener('mousemove', (e) => {
			if (isDragging) {
				e.preventDefault();
				handleJoystickMove(e.clientX, e.clientY);
			}
		});
		
		document.addEventListener('mouseup', (e) => {
			if (isDragging) {
				e.preventDefault();
				resetJoystick();
			}
		});
		
		// Obsługa przycisków akcji
		const actionButtons = document.querySelectorAll(".action-btn");
		
		actionButtons.forEach(button => {
			button.addEventListener("touchstart", (e) => {
				e.preventDefault();
				e.stopPropagation();
				const key = button.getAttribute("data-key");
				button.classList.add("pressed");
				pressKey(key);
			});
			
			button.addEventListener("touchend", (e) => {
				e.preventDefault();
				e.stopPropagation();
				const key = button.getAttribute("data-key");
				button.classList.remove("pressed");
				releaseKey(key);
			});
			
			button.addEventListener("touchcancel", (e) => {
				e.preventDefault();
				const key = button.getAttribute("data-key");
				button.classList.remove("pressed");
				releaseKey(key);
			});
			
			button.addEventListener("mousedown", (e) => {
				e.preventDefault();
				e.stopPropagation();
				const key = button.getAttribute("data-key");
				button.classList.add("pressed");
				pressKey(key);
			});
			
			button.addEventListener("mouseup", (e) => {
				e.preventDefault();
				e.stopPropagation();
				const key = button.getAttribute("data-key");
				button.classList.remove("pressed");
				releaseKey(key);
			});
			
			button.addEventListener("mouseleave", (e) => {
				const key = button.getAttribute("data-key");
				button.classList.remove("pressed");
				releaseKey(key);
			});
			
			button.addEventListener("touchmove", (e) => {
				e.preventDefault();
			});
			
			button.addEventListener("contextmenu", (e) => {
				e.preventDefault();
			});
		});
		
		// Automatyczne ustawienie fokusa na grze po kliknięciu
		document.addEventListener("DOMContentLoaded", () => {
			const embed = document.querySelector("embed");
			if (embed) {
				embed.addEventListener("click", () => {
					const player = document.querySelector("ruffle-player") || document.querySelector("embed");
					if (player && player.focus) player.focus();
				});
			}
		});
	</script>


	<!-- Uniwersalne sterowanie -->
	<script src="../game-controls.js"></script>
</body>
</html>